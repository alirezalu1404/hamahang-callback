<!doctype html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Ø¨Ø§Ø²Ú¯Ø´Øª OAuth | Ù‡Ù…Ø§Ù‡Ù†Ú¯</title>
  <style>
    body{font-family:Tahoma,Arial,sans-serif;max-width:720px;margin:32px auto;padding:0 16px;line-height:1.8}
    code,pre{background:#f6f8fa;padding:2px 6px;border-radius:6px;direction:ltr}
    .ok{color:#0a7}
    .err{color:#c00}
    .box{border:1px solid #e5e7eb;border-radius:12px;padding:16px;margin:16px 0}
    button{padding:8px 12px;border:1px solid #ddd;border-radius:8px;background:#fff;cursor:pointer}
    a.btn{display:inline-block;padding:10px 16px;margin-top:10px;border:1px solid #0a7;background:#0a7;color:#fff;text-decoration:none;border-radius:8px}
  </style>
</head>
<body>
  <h1>ðŸ“Ž Ù†ØªÛŒØ¬Ù‡ Ø¨Ø§Ø²Ú¯Ø´Øª OAuth (Ø¯ÛŒÙˆØ§Ø±)</h1>

  <div class="box">
    <p>Ø¨Ø±Ø§ÛŒ ÙˆØ±ÙˆØ¯ Ø¨Ø§ Ø¯ÛŒÙˆØ§Ø±ØŒ Ø±ÙˆÛŒ Ø¯Ú©Ù…Ù‡ Ø²ÛŒØ± Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯:</p>
    <a id="loginBtn" class="btn">ÙˆØ±ÙˆØ¯ Ø¨Ø§ Ø¯ÛŒÙˆØ§Ø±</a>
  </div>

  <div class="box">
    <p>Ø§Ú¯Ø± Ø§Ø¬Ø§Ø²Ù‡ ØµØ§Ø¯Ø± Ø´Ø¯Ù‡ Ø¨Ø§Ø´Ø¯ØŒ Ø¨Ø§ÛŒØ¯ Ù¾Ø§Ø±Ø§Ù…ØªØ± <code>code</code> Ø§ÛŒÙ†Ø¬Ø§ Ø¨ÛŒØ§ÛŒØ¯.</p>
    <p><strong>state:</strong> <span id="state">â€”</span></p>
    <p><strong>code:</strong> <span id="code">â€”</span></p>
    <p class="err"><strong>error:</strong> <span id="error">â€”</span></p>
    <p class="err"><strong>error_description:</strong> <span id="error_description">â€”</span></p>
    <p><button id="copyBtn">Ú©Ù¾ÛŒ code</button></p>
  </div>

  <script>
    // Ø®ÙˆØ§Ù†Ø¯Ù† Ù¾Ø§Ø±Ø§Ù…ØªØ±Ù‡Ø§ Ø§Ø² URL
    const params = new URLSearchParams(location.search);
    const set = (id, val) => document.getElementById(id).textContent = val || 'â€”';
    const state = params.get('state');
    const code = params.get('code');
    const error = params.get('error');
    const error_description = params.get('error_description');
    set('state', state);
    set('code', code);
    set('error', error);
    set('error_description', error_description);

    // Ø¯Ú©Ù…Ù‡ Ú©Ù¾ÛŒ
    document.getElementById('copyBtn').addEventListener('click', () => {
      if (!code) return alert('Ú©Ø¯ÛŒ Ø¨Ø±Ø§ÛŒ Ú©Ù¾ÛŒ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯.');
      navigator.clipboard.writeText(code).then(() => alert('Ú©Ù¾ÛŒ Ø´Ø¯!'));
    });

    // Ø¯Ú©Ù…Ù‡ ÙˆØ±ÙˆØ¯ Ø¨Ø§ Ø¯ÛŒÙˆØ§Ø±
    document.getElementById('loginBtn').addEventListener('click', () => {
      const stateValue = "mysecurestate12345";
      const clientId = "bloom-pine-jester";
      const redirectUri = "https://alirezalu1404.github.io/hamahang-callback/index.html";
      const scopes = "CHAT_SEND_MESSAGE_OAUTH CHAT_READ_CONVERSATION CHAT_UPLOAD_MEDIA CHAT_BOT_SEND_MESSAGE";
      // ðŸš€ Ù…Ø³ÛŒØ± ØµØ­ÛŒØ­ Ø§Ø­Ø±Ø§Ø² Ø¯ÛŒÙˆØ§Ø±
      const url = `https://oauth.divar.ir/oauth2/auth?client_id=${clientId}&redirect_uri=${encodeURIComponent(redirectUri)}&response_type=code&scope=${encodeURIComponent(scopes)}&state=${stateValue}`;
      window.location.href = url;
    });
  </script>
</body>
</html>
